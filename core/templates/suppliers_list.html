{% extends 'base.html' %}
{% load static %}

{% block title %}عرطات دوتكم{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/suppliers.css' %}">
{% endblock %}

{% block content %}
<!-- Modern Hero Section -->

<div class="container pt-12">
    <!-- Filter & Categories -->
<div class="category-nav-wrapper">
    <div class="container">
        <span class="filter-label">استكشف عبر التصنيفات</span>
        <div class="category-scroll-container">
            <button class="category-pill active" data-category="all" onclick="filterByCategory('all')">
                <i class="fas fa-border-all"></i>
                <span>الكل</span>
            </button>
            {% for category in categories %}
            <button class="category-pill" data-category="{{ category.id }}" onclick="filterByCategory('{{ category.id }}')">
                {% if category.image %}
                    <img src="{{ category.image.url }}" alt="{{ category.name }}" style="width: 18px; height: 18px; border-radius: 4px;">
                {% else %}
                    <i class="fas fa-tag"></i>
                {% endif %}
                <span>{{ category.name }}</span>
            </button>
            {% endfor %}
        </div>
    </div>
</div>

    <!-- Suppliers Grid -->
    <div class="supplier-grid">
        <div class="row" id="supplierGrid">
            {% for supplier in suppliers %}
            <div class="col-lg-4 col-md-6 mb-8 supplier-card-container" data-categories="{% for cat in supplier.category.all %}{{ cat.id }},{% endfor %}">
                <div class="supplier-card">
                    <div class="supplier-cover" style="{% if supplier.panal_picture %}background-image: url('{{ supplier.panal_picture.url }}'); background-size: cover; background-position: center;{% else %}background-color: {{ supplier.primary_color }}22;{% endif %}"></div>
                    <div class="supplier-logo-wrapper">
                        <img src="{% if supplier.profile_picture %}{{ supplier.profile_picture.url }}{% else %}{% static 'logo.png' %}{% endif %}" alt="{{ supplier.name }}">
                    </div>
                    
                    <div class="supplier-content">
                        <h3 class="supplier-name">{{ supplier.name }}</h3>
                        
                        <div class="supplier-meta">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>{{ supplier.city }}, {{ supplier.country }}</span>
                        </div>
                        
                        <div class="supplier-tags">
                            {% for category in supplier.category.all %}
                                <span class="supplier-tag">{{ category.name }}</span>
                            {% endfor %}
                        </div>

                        <div class="supplier-footer">
                            <div class="rating text-warning font-bold">
                                <i class="fas fa-star ml-1"></i>4.9
                            </div>
                            <button class="btn-visit" onclick="window.location='{% url 'product-list' supplier.store_id %}'">
                                زيارة المتجر
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            {% empty %}
            <div class="col-12">
                <div class="no-suppliers">
                    <i class="fas fa-store-slash"></i>
                    <h3>لا توجد متاجر متاحة حالياً</h3>
                    <p class="text-muted">لم يتم العثور على أي متاجر تتوافق مع بحثك</p>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<!-- Features Section Clean -->
<section class="features-container">
    <div class="container">
        <div class="row text-center mb-12">
            <h2 class="fw-bold">لماذا تختار منصتنا؟</h2>
        </div>
        <div class="row">
            <div class="col-md-4">
                <div class="feature-item">
                    <div class="feature-icon-box"><i class="fas fa-store"></i></div>
                    <h3>متاجر معتمدة</h3>
                    <p>جميع متاجرنا تخضع لرقابة صارمة لضمان حقوق المستهلك وجودة المنتجات المعروضة.</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="feature-item">
                    <div class="feature-icon-box"><i class="fas fa-shipping-fast"></i></div>
                    <h3>سرعة في التنفيذ</h3>
                    <p>نعمل مع أفضل شركات الخدمات اللوجستية لضمان وصول طلبك في الوقت المحدد.</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="feature-item">
                    <div class="feature-icon-box"><i class="fas fa-shield-alt"></i></div>
                    <h3>دفع آمن</h3>
                    <p>نوفر خيارات دفع متعددة وآمنة تماماً، بما في ذلك الدفع عند الاستلام ومدى.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
function filterByCategory(categoryId) {
    const cards = document.querySelectorAll('.supplier-card-container');
    const buttons = document.querySelectorAll('.category-pill');
    
    buttons.forEach(btn => {
        if (btn.getAttribute('data-category') === categoryId) {
            btn.classList.add('active');
        } else {
            btn.classList.remove('active');
        }
    });

    cards.forEach(card => {
        if (categoryId === 'all') {
            card.style.display = 'block';
        } else {
            const categories = card.getAttribute('data-categories').split(',');
            if (categories.includes(categoryId)) {
                card.style.display = 'block';
            } else {
                card.style.display = 'none';
            }
        }
    });
}
</script>
{% endblock %}